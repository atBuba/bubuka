# Тестовое задание 

### Загрузка модели

Поскольку модель слишком большая, необходимо скачать папку с моделью и токенизатором из [гугл диска](https://drive.google.com/drive/folders/1iC3Drhlkoo_fvF2yXPVPhLxSBjmmWetE?usp=sharing) и сохранить, как папку model.

Должна получиться следующая иерархия
```
bubuka/
├── interface.py
├── model/
│   ├── config.json
│   ├── pytorch_model.bin
│   ├── tokenizer.json
│   ├── tokenizer_config.json
│   ├── vocab.txt
└── templates/
    └── index.html
```

### Запуск проекта

Web-приложение запускается командой 
```bash
python interface.py
```

### Работа Web-приложения

Приложение запускается на http://127.0.0.1:5000

Интерфейс приложения

![Снимок экрана 2024-09-16 в 12 09 46](https://github.com/user-attachments/assets/94863be7-06ca-449a-9922-992ecce50e4f)

Для анализа текста необходимо вставить текст в поле для ввода и нажать кнопку Классифицировать.

![Снимок экрана 2024-09-16 в 12 12 32](https://github.com/user-attachments/assets/9cf12f03-1d70-4df3-b361-d570570a326c)



# Этапы работы 

### Создание датасета

Чтобы собрать датасет я парсил текста песен с сайта https://text-you.ru/search.html. Поиск песен осуществлял по ключевым словам в тексте, например если мы ищем песни для категории Любовь/Романтика, то поиск будет проходить по словам любовь, сердце, любимый и тд. Так был собран датасет размеченный на 7 вариантов категорий текстов песен. (Грусть/Печаль/Страдания, Оптимизм/Веселье/Счастье, Новый год/Рождество, Любовь/Романтика, Патриотическая песня, Лето, Осень)

### Обучение модели 

Я взял [rubert-base-cased](https://huggingface.co/DeepPavlov/rubert-base-cased) и дообучил ее на многоклассовую классификацию, код с обучением также предоставляю (bubuka.ipynb). 

Метрики мой модели, которые я считал со своего же датасета (с части которую не видела модель)
![Снимок экрана 2024-09-16 в 12 25 10](https://github.com/user-attachments/assets/c418dec4-3a49-4ca2-8b11-dc145f08d9ef)

Проблема возникла только с Патриотическими песнями, поскольку мне не удалось найти большого количество текстов патриотических песен. 

### Web-приложение 
Web-интерфейс написан на Flask, раньше с ним опыта работы не имел, поэтому сделал как смог









